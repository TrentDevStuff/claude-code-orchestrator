---
created: 2026-01-31T11:45:00Z
type: plan
effort: EFFORT-Agent-Discovery-Phase-1
status: approved
---

# Phase 1: Agent/Skill Discovery CLI - Implementation Plan

## Executive Summary

Add CLI commands to discover, search, and inspect agents/skills available through the Claude Code API Service. Simple implementation reusing existing infrastructure - **no API changes required**.

---

## Implementation Tasks

### Task 1: Create agents/skills command module
**File:** `cli/commands/discovery.py` (combined agents + skills)

**Commands to implement:**
1. `agents list` - List all agents with filtering
2. `agents info AGENT_NAME` - Show detailed agent info
3. `agents search QUERY` - Search agents by keyword
4. `skills list` - List all skills with filtering
5. `skills info SKILL_NAME` - Show detailed skill info
6. `skills search QUERY` - Search skills by keyword

**Reuse existing:**
- `cli/api_client.py` - Already has `get_capabilities()` method
- `src/agent_discovery.py` - Does the actual discovery
- Rich library - For beautiful table formatting

**Estimated:** 1.5 hours

---

### Task 2: Integrate into main CLI
**File:** `cli/claude_api.py`

**Changes:**
```python
from .commands import ..., discovery

app.add_typer(discovery.agents_app, name="agents")
app.add_typer(discovery.skills_app, name="skills")
```

**Estimated:** 5 minutes

---

### Task 3: Testing
**Commands to test:**
```bash
# Agents
claude-api agents list
claude-api agents list --model haiku
claude-api agents list --json
claude-api agents info company-workflow-analyst
claude-api agents search workflow

# Skills
claude-api skills list
claude-api skills info semantic-text-matcher
claude-api skills search pdf
```

**Estimated:** 15 minutes

---

### Task 4: Documentation updates

**Files to update:**
1. `cli/README.md` - Add agents/skills section
2. `.claude/skills/claude-api-cli/SKILL.md` - Add discovery commands
3. `~/.claude/rules/claude-api-cli.md` - Add quick reference

**Estimated:** 30 minutes

---

## Command Specifications

### `claude-api agents list`

**Options:**
- `--model MODEL` - Filter by model (haiku, sonnet, opus)
- `--json` - Output as JSON

**Output (table format):**
```
                Available Agents (25)
┌──────────────────────────────┬─────────┬────────────────┐
│ Name                         │ Model   │ Tools          │
├──────────────────────────────┼─────────┼────────────────┤
│ company-workflow-analyst     │ sonnet  │ Read, Write... │
│ accessibility-auditor        │ opus    │ Read, Bash...  │
│ ...                          │ ...     │ ...            │
└──────────────────────────────┴─────────┴────────────────┘

Total: 25 agents
```

---

### `claude-api agents info AGENT_NAME`

**Output:**
```
              company-workflow-analyst
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
Model:        sonnet
Description:  DUAL-MODE WORKFLOW ANALYST - Extracts
              workflow data from meeting transcripts...

Tools:        Read, Write, Edit, MultiEdit, Bash, Grep,
              Glob, Documentation

How to Use:
  Task(
    subagent_type="company-workflow-analyst",
    prompt="Extract workflow from transcript",
    description="Extract workflow"
  )
```

---

### `claude-api agents search QUERY`

**Output:**
```
Search results for "workflow" (5 agents):

  • company-workflow-analyst (sonnet)
    DUAL-MODE WORKFLOW ANALYST - Extracts workflow...

  • workflow-sync-agent (sonnet)
    STAGE 2 INTEGRATION SPECIALIST - Augments...

  • workflow-direct-modifier (sonnet)
    DIRECT MODIFICATION SPECIALIST - Updates...

  • workflow-structure-agent (sonnet)
    SCHEMA AND STRUCTURE SPECIALIST - Validates...

  • ganf-workflow-generator (sonnet)
    GANF WORKFLOW GENERATOR - Converts operational...
```

---

### `claude-api skills list`

**Options:**
- `--json` - Output as JSON

**Output:**
```
              Available Skills (17)
┌─────────────────────────────┬────────────────────────┐
│ Name                        │ Description            │
├─────────────────────────────┼────────────────────────┤
│ semantic-text-matcher       │ Text similarity...     │
│ entity-mapper               │ Map free-text to...    │
│ ...                         │ ...                    │
└─────────────────────────────┴────────────────────────┘

Total: 17 skills
```

---

### `claude-api skills info SKILL_NAME`

**Output:**
```
           semantic-text-matcher
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
Description:  Intelligent text similarity using
              semantic embeddings. Compare texts
              based on meaning, not just keywords.

Automation:   85-95% accuracy

How to Use:
  Skill(command="semantic-text-matcher")
```

---

## Implementation Code Structure

```python
# cli/commands/discovery.py

import typer
from rich.console import Console
from rich.table import Table
from ..api_client import APIClient
from ..utils import print_success, print_error, create_data_table

# Separate apps for agents and skills
agents_app = typer.Typer(help="Agent discovery and inspection")
skills_app = typer.Typer(help="Skill discovery and inspection")

@agents_app.command("list")
def list_agents(
    model: str = typer.Option(None, help="Filter by model"),
    json_output: bool = typer.Option(False, "--json")
):
    """List all available agents"""
    # 1. Get capabilities from API
    # 2. Filter by model if specified
    # 3. Format as table or JSON
    # 4. Print

@agents_app.command("info")
def agent_info(name: str = typer.Argument(...)):
    """Show detailed information about an agent"""
    # 1. Get capabilities
    # 2. Find agent by name
    # 3. Format detailed info
    # 4. Show usage example

@agents_app.command("search")
def search_agents(query: str = typer.Argument(...)):
    """Search agents by keyword"""
    # 1. Get capabilities
    # 2. Search in name + description
    # 3. Show matching agents

# Same structure for skills
@skills_app.command("list")
def list_skills(...):
    pass

@skills_app.command("info")
def skill_info(...):
    pass

@skills_app.command("search")
def search_skills(...):
    pass
```

---

## Success Criteria

- ✅ All 6 commands implemented and working
- ✅ Beautiful Rich table formatting
- ✅ JSON output option for all list commands
- ✅ Search works (case-insensitive, name + description)
- ✅ Filtering works (--model for agents)
- ✅ Help text for all commands
- ✅ Documentation updated
- ✅ No errors or crashes

---

## Testing Checklist

```bash
# Agents
[ ] claude-api agents list
[ ] claude-api agents list --model haiku
[ ] claude-api agents list --model sonnet
[ ] claude-api agents list --model opus
[ ] claude-api agents list --json
[ ] claude-api agents info company-workflow-analyst
[ ] claude-api agents info INVALID_NAME (should error gracefully)
[ ] claude-api agents search workflow
[ ] claude-api agents search pdf
[ ] claude-api agents search NONEXISTENT (should show "no results")

# Skills
[ ] claude-api skills list
[ ] claude-api skills list --json
[ ] claude-api skills info semantic-text-matcher
[ ] claude-api skills info INVALID_NAME (should error gracefully)
[ ] claude-api skills search text
[ ] claude-api skills search matching
[ ] claude-api skills search NONEXISTENT (should show "no results")

# Help
[ ] claude-api agents --help
[ ] claude-api agents list --help
[ ] claude-api skills --help
```

---

## Timeline

**Start:** After approval
**Estimated Duration:** 2-3 hours
**Breakdown:**
- Implementation: 1.5 hours
- Testing: 15 minutes
- Documentation: 30 minutes
- Buffer: 15 minutes

---

## Files to Create/Modify

**Create:**
- `cli/commands/discovery.py` (~250 lines)
- `EFFORT-Agent-Discovery-Phase-1/PLAN-Phase-1-*.md` (this file)

**Modify:**
- `cli/claude_api.py` (add command groups)
- `cli/README.md` (add agents/skills section)
- `.claude/skills/claude-api-cli/SKILL.md` (add discovery commands)
- `~/.claude/rules/claude-api-cli.md` (add quick reference)

---

## Ready to Execute

Plan approved - proceeding with implementation!
